###########################################
## rubiks
###########################################

# Work around a bug in gcc 4.6.0: http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702
if [ "`testcc.sh $CC`" = GCC ] ; then
    if $CC -dumpversion 2>/dev/null |grep >/dev/null '^4\.6\.[01]$' ; then
        echo "Warning: Working around bug in gcc 4.6.0"
        OPTIMIZATION_FLAGS="-fno-ivopts"
        CFLAGS="$CFLAGS $OPTIMIZATION_FLAGS "
        CXXFLAGS="$CXXFLAGS $OPTIMIZATION_FLAGS "
        FCFLAGS="$FCFLAGS $OPTIMIZATION_FLAGS "
        F77FLAGS="$F77FLAGS $OPTIMIZATION_FLAGS "
        export CFLAGS
        export CXXFLAGS
        export FCFLAGS
        export F77FLAGS
    fi
fi

# These are all used by GNU to specify compilers.
echo "Using CC=$CC"
echo "Using CXX=$CXX"
echo "Using FC=$FC"
echo "Using F77=$F77"

# Flags which may be set.
echo "The following environment variables will be exported"
echo "Using CFLAGS=$CFLAGS"
echo "Using CXXFLAGS=$CXXFLAGS"
echo "Using FCFLAGS=$FCFLAGS"
echo "Using F77FLAGS=$F77FLAGS"
echo "Using CPPFLAGS=$CPPFLAGS"
echo "Using LDFLAGS=$LDFLAGS"
echo "Using ABI=$ABI"
echo "configure scripts and/or makefiles might override these later"
echo " "

# End of pretty general spkg-install file.
# Now do the specific things needed for this package (rubiks)

if [ $UNAME = "SunOS" ]; then
    INSTALL=cp; export INSTALL
else
    INSTALL=install; export INSTALL
fi

cd src

echo "Building Rubiks cube solvers"
sdh_make_install PREFIX="$SAGE_LOCAL"
